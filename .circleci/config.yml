version: 2
jobs:
  build:
    machine: true
    steps:
    - checkout
    - run: docker login -u $DOCKER_USER -p $DOCKER_PASS quay.io
    - run: docker pull quay.io/giantswarm/opsctl
    - run:
        name: Validate AWS releases
        command: docker run --rm -v /home/circleci/project/:/run/installations/ quay.io/giantswarm/opsctl validate releases -p /run/installations/release/provider/aws.yaml
    - run:
        name: Validate Azure releases
        command: docker run --rm -v /home/circleci/project/:/run/installations/ quay.io/giantswarm/opsctl validate releases -p /run/installations/release/provider/azure.yaml
    - run:
        name: Validate KVM releases
        command: docker run --rm -v /home/circleci/project/:/run/installations/ quay.io/giantswarm/opsctl validate releases -p /run/installations/release/provider/kvm.yaml
