## :zap:  Giant Swarm Release 11.3.0 for Azure :zap:

This release replaces CoreOS Container Linux that is going [end of life](https://coreos.com/os/eol/) on the 26th of May 2020 with Flatcar Container Linux. 

**The creation of new clusters with this release works as usual. New clusters will contain Flatcar OS from the start.**

Flatcar Container Linux images, contrary to the CoreOS Container Linux image, is under a license which you need to accept. Please look into the instructions prior to creating or upgrading your clusters [here](https://github.com/giantswarm/releases/blob/master/announcements/11-3-0-azure-flatcar-licence-approval.md)

Migration process requires replacing VMSS CoreOS image with Flatcar image which, [due to Azure limitations](https://docs.microsoft.com/en-us/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-upgrade-scale-set#create-time-properties), is not possible. In order to enable existing clusters to upgrade with this release we had to amend standard procedure with additional steps that replace old VMSS with a new one, ensuring all workload is moved. 

### Warning
The following steps will be undertaken during the upgrade procedure:
1. Once you start the upgrade, we will be notified in order to be hands on during the procedure.
2. Upgrade will start with master replacement. Here old master is stopped as we need a final state of the ETCD data for the migration. Then new VMSS master instance is created (which due to Azure recent performance with disk provisioning can take several tries, hence extend the upgrade time). 
It is important to remember that while the switch is in progress for masters, the workloads will be working as long as they do not fail, as the rescheduling will not be possible.
3. When the new VMSS master instance is ready, the upgrade will be waiting for the GS staff to migrate the ETCD data manually from the old master instance to the new one. After the migration is done on our side, the old instance will be removed and the new instance will join the cluster.
4. After the master is upgraded successfully, the upgrade will proceed with the worker instances. Here, the process is simpler. The Azure Operator will create a VMSS with Flatcar Container Linux images and migrate the workloads, as you are used to during the previous upgrades.
5. Finally, when all your workload is migrated, the VMSS running the CoreOS Container Linux instances will be deleted.

Due to the additional steps in the upgrade process, the whole procedure will take more time. As it also requires a manual intervention on our side, could you please **schedule all the upgrades to 11.3.0 with your Solution Engineer at least a day in advance**. This will allow us to prepare and guarantee you the appropriate support throughout the upgrade process.

Our initial tests showed up to 2% loss of incoming traffic over the time period of 5-10min. It was not reproduced in the following tests but because of the complexity of the process you should be aware that this may occur.
